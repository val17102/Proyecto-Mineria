---
title: "Proyecto No.1"
author: "Héctor Valle, Rodrigo Samayoa & Paul Belches"
date: "23/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
library(dplyr)
theme_set(theme_pubr())
datos<-read.csv("importacionesVehiculosSAT.csv", stringsAsFactors = FALSE)
datos<-datos[,-c(2,3,4,11,17)]
datos<-na.omit(datos)
```

```{r}
library(stringr)
#setwd("~/Documents/Mineria/Proyecto-Mineria/")
datosIne<-read.csv("mortalidadIne2.csv", header=FALSE, stringsAsFactors=FALSE, fileEncoding="latin1")
#names(datosIne)[1] <- "hola"
names(datosIne)[1] <- "depocu"
names(datosIne)[2] <- "mupocu"	
names(datosIne)[3] <- "sexo"
names(datosIne)[4] <- "diaocu"
names(datosIne)[5] <- "anoreg"
names(datosIne)[6] <- "mesocu"
names(datosIne)[7] <- "edadif"
names(datosIne)[8] <- "ecidif"
names(datosIne)[9] <- "escodif"
names(datosIne)[10] <- "dredif"
names(datosIne)[11] <- "mredif"
names(datosIne)[12] <- "caudef"
#Only letter
datosIne <- datosIne[-1,]
datosIne$caudef <- substr(datosIne$caudef, 1, 1)
datosIne<-filter(datosIne, caudef == "V")
#Eliminate special characters
datosIne$depocu <- str_replace_all(datosIne$depocu, "[^[:alnum:]]", "")
datosIne$mupocu <- str_replace_all(datosIne$mupocu, "[^[:alnum:]]", "")
datosIne$mesocu <- str_replace_all(datosIne$mesocu, "[^[:alnum:]]", "")
datosIne$escodif <- str_replace_all(datosIne$escodif, "[^[:alnum:]]", "")
datosIne$dredif <- str_replace_all(datosIne$dredif, "[^[:alnum:]]", "")
datosIne$mredif <- str_replace_all(datosIne$mredif, "[^[:alnum:]]", "")
#datosIne$caudef > "V00"
#Eliminate (a)
datosIne$ecidif <- str_replace_all(datosIne$ecidif, "\\(a\\)", "")
#Only letter
datosIne <- datosIne[-1,]
datosIne$caudef <- substr(datosIne$caudef, 1, 1)
datosIne<-filter(datosIne, caudef == "V")
#Eliminate special characters
datosIne$depocu <- str_replace_all(datosIne$depocu, "[^[:alnum:]]", "")
datosIne$mupocu <- str_replace_all(datosIne$mupocu, "[^[:alnum:]]", "")
datosIne$mesocu <- str_replace_all(datosIne$mesocu, "[^[:alnum:]]", "")
datosIne$escodif <- str_replace_all(datosIne$escodif, "[^[:alnum:]]", "")
datosIne$dredif <- str_replace_all(datosIne$dredif, "[^[:alnum:]]", "")
datosIne$mredif <- str_replace_all(datosIne$mredif, "[^[:alnum:]]", "")
#datosIne$caudef > "V00"
#Eliminate (a)
datosIne$ecidif <- str_replace_all(datosIne$ecidif, "\\(a\\)", "")
```

### Descripción de  la situación problemática:

Los accidentes de tránsito son la segunda causa de muerte en Guatemala, por detrás de los incidentes que involucran armas de fuego. Diariamente alrededor de 17 accidentes de tránsito deja varios fallecidos según el Instituto Nacional de Ciencias Forenses. A pesar de que los incidentes han disminuido en cantidad durante el plazo 2018 - 2019, la magnitud de los accidentes y la cantidad de muertes solo ha aumentado. En comparación, el año 2019 ha excedido a su predecesor por más de 113 muertes. Las causas varían relacionando a todo tipo de vehiculos, buses de transporte extraurbano, transporte de carga y automóviles livianos. Por lo que se busca determinar el impacto de las crecientes importaciones de vehículos, en este fenómeno. 

### Problema científico y Objetivos preliminares. 

Identificar la categoría de vehículo que está involucrada en  mayor cantidad de accidentes de tránsito que  resulte en la muerte de las personas. Tomando en cuenta la proporción que representan tránsito vehicular, para determinar su impacto. 

Identificar las condiciones en que estos accidentes de tránsito ocurren en mayor consistencia.

Identificar las causas principales de de estos accidentes de tránsito.

Determinar si la categoría vehicular con mayor culpabilidad de accidentes, es la que cuenta con mayor crecimiento por importación. 

### Información a utilizar 

Para responder la problemática que se presenta, se utilizaran:

- Base de datos de la importaciones de la SAT
- Base de datos de defunciones del Ine

#### Descripcion de Variables:

##### **SAT**

**Pais de Provinencia (Cualitativa Nominal):**
País del que proviene el vehiculo

**Aduana de ingreso (Cualitativa Nominal):**
Nombre de la aduana en la que el vehiculo ingreso

**Fecha de la Poliza (Cualitativa Ordinal):**
Fecha en la que el carro es registrado

**Partida Arancelaria (Cuantitativa Discreta):**
Codigo de distincion para saber al grupo de pago de impuestos al que pertenece

**Modelo del Vehiculo (Cualitativa Ordinal):**
Modelo del vehiculo

**Marca (Cualitativa Nominal): **
Marca del vehiculo

**Linea (Cualitativa Nominal):**
Linea del vehiculo 

**Centimetros Cubicos (Cuantitativa Discreta): **
Tamaño del motor

**Distintivo (Cualitativa Nominal):**
Distintivo del vehiculo

**Tipo de Vehiculo (Cualitativa Nominal):**
Tipo de vehiculo

**Tipo de Importador (Cualitativa Nominal):**
Tipo de importador (OCASIONAL o DISTRIBUIDOR)

**Tipo Combustible (Cualitativa Nominal):**
Combustible que utiliza el vehiculo

**Asientos (Cuantitativa Discreta):**
Numero de asientos que tiene el vehiculo

**Puertas (Cuantitativa Discreta):**
Numero de puertas que tiene el vehiculo

**Tonelaje (Cuantitativa Discreta):**
Peso del vehiculo

**Valor VIF (Cuantitativa Continua):**
Costo del vehiculo despues de haber pagado impuestos

**Impuesto (Cuantitativa Continua):**
Cantidad de impuestos que se debe pagar

En el caso de la SAT, las variables que se utilizarán son País de Provinencia, Modelo del Vehículo, Marca, Línea, Centímetros Cúbicos, Distintivo, Tipo de Vehículo, Tipo de Combustible, Asientos, Puertas, Tonelaje y Valor CIF. Estas variables se eligieron debido a que luego de identificar las características de los vehículos involucrados en accidentes fatales, se evaluarían sus características en el ámbito de importaciones.

Para el dataset de importaciones de la SAT los procesos de limpieza que se realizaron fueron los siguientes: Se eliminaron todas las filas en las cuales existieran valores nulos para algunos de las columnas. Luego se buscó estandarizar los datos categóricos, asegurando que no existieron caracteres especiales en los diferentes valores. Los valores que se buscaron fueron tildes y signos de puntuación, pero estos no se encontraron ya que todas las variables con caracteres estaban en mayúsculas y sin tildes.

#### **INE**

La base de datos de defucniones del INE, busca alamcenar toda la información pertienente en relación al deceso de una persona dentro del territorio nacialonal. Registrando la mayor cantidad de datos en relación al suceso. A continuación se presenta una lista de las variables presentes dentro de este set de datos, además de el valor que representan. 

**Depocu (Cualitativa Nominal):**
Departamento de registro

**Mupocu (Cualitativa Nominal):**
Municipio de registro

**Mesreg (Cualitativa Nominal):**
Mes de registro

**Añoreg (Cualitativa Ordinal):**
Año de registro

**Depocu (Cualitativa Ordinal):**
Departamento de ocurrencia

**Mupocu (Cualitativa Nominal):**
Municipio de ocurrencia 

**Sexo (Cualitativa Nominal):**
Mes de ocurrencia

**Añoocu (Cualitativa Ordinal):**
Año de ocurrencia

**Edadif (Cualitativa Ordinal):**
Edad del difunto

**Perdif (Cualitativa Ordinal):**
Periodo de edad del difunto

**Puedif (Cualitativa Ordinal):**
Pueblo al que pretenece el difunto

**Ecidif (Cualitativa Nominal):**
Estado civil del difunto

**Escodif (Cualitativa Nominal):** 
Ecolaridad del difunto

**Ciuodif (Cualitativa Nominal):**
Ocupación del difunto

**Pnadif (Cualitativa Nominal):**
País de nacieminto del equipo

**Dnadif (Cualitativa Nominal):**
Departamento de nacimiento del difunto

**Mnadif (Cualitativa Nominal):**
Municipio del nacimiento del difunto

**Nacdif (Cualitativa Nominal):**
Nacionalidad del difunto

**Predif (Cualitativa Nominal):**
País de recidencia del difunto

**Dredif (Cualitativa Nominal):**
Departamento de recidencia del difunto

**Mredif (Cualitativa Nominal):**
Municipio de recidencia del difunto

**Caudef (Cualitativa Nominal):**
Causa de defunción

**Asist (Cualitativa Nominal):**
Asistencia recibida

**Oucr (Cualitativa Nominal):**
Sitio de ocurrencia

**Cerdef (Cualitativa Nominal):**
Quien certifica

En el caso de Ine, las variables a utilizar serán, depocu, mupocu, sexo, diaocu, añoreg, mesocu, edadif, ecidif, escodif, dredif, mredif, caudef. Esto en primer lugar, gracias a que son variables que se encuentran presentes en todos los datasets año tras año, del 2011 al 2018. Además en variables como la ocupación del difunto el valor indefinido se encuetra respetidas veces por lo que no permite la extracción de información de manera adecuada. 

### **Tablas de frecuencia de variables elegidas**

#### **SAT**

Como se puede observar en la gráfica, solo se presentan 10 países, esto se debe a que la cantidad de países dentro de los datos es muy grande para poder graficarlos de tal manera que se pueda identificar los países claramente, por lo cual se eligieron los 10 países con la mayor cantidad de instancias. Se pueden observar los países con la cantidad más grande de instancias de importaciones son China, Japón y Estado Unidos.

#### **Pais de Proveniencia**
```{r}
#Pais de Proveniencia
df <- datos %>%
  group_by(Pais.de.Proveniencia) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df[1:10,]
ggplot(df[1:10,], aes(x = reorder(Pais.de.Proveniencia,count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.3) + theme_pubclean()

```

Esta gráfica presenta la distribución de el año de modelo de los vehículos, y como se puede observar, la tasa de crecimiento a lo largo de los años ha sido exponencial, de tal manera que la cantidad de importaciones año tras año ha ido incrementando, con últimos 3 años como los que tienen la mayor cantidad.

#### **Modelo de Vehículo**
```{r}
#Modelo de Vehiculo
df <- datos %>%
  group_by(Modelo.del.Vehiculo) %>%
  summarise(count = n())
df
ggplot(df, aes(x = Modelo.del.Vehiculo, y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = ""), vjust = -0.5) + theme_pubclean()
hist(datos$Modelo.del.Vehiculo)
```

#### **Marca**
```{r}
#Marca
df <- datos %>%
  group_by(Marca) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df[1:10,], aes(x = reorder(Marca,count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Linea**
```{r}
#Linea
df <- datos %>%
  group_by(Linea) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df[1:10,], aes(x = reorder(Linea,count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Centimetros Cubicos**
```{r}
#Centimetros.Cubicos
df <- datos %>%
  group_by(Centimetros.Cubicos) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df[1:10,], aes(x = reorder(Centimetros.Cubicos,count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Distintivo**
```{r}
#Distintivo
df <- datos %>%
  group_by(Distintivo) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df
ggplot(df, aes(x = reorder(Distintivo,count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Tipo de Vehiculo**
```{r}
#Tipo de Vehiculo
df <- datos %>%
  group_by(Tipo.de.Vehiculo) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df[1:10,], aes(x = reorder(Tipo.de.Vehiculo,count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Tipo de Combustible**
```{r}
#Tipo de Combustible
df <- datos %>%
  group_by(Tipo.Combustible) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df, aes(x = reorder(Tipo.Combustible, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Asientos**
```{r}
#Asientos
df <- datos %>%
  group_by(Asientos) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df[1:10,], aes(x = reorder(Asientos, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Puertas**
```{r}
#Puertas
df <- datos %>%
  group_by(Puertas) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df, aes(x = reorder(Puertas, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Tonelaje**
```{r}
#Tonelaje
df <- datos %>%
  group_by(Tonelaje) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df[1:10,], aes(x = reorder(Tonelaje, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

#### **Valor CIF**
```{r}
#Valor.CIF
df <- datos %>%
  group_by(Valor.CIF) %>%
  summarise(count = n())
df <- df[order(-df$count),]
hist(df$Valor.CIF)

```

#### **Año**
```{r}
df <- datos %>%
  group_by(Anio) %>%
  summarise(count = n())
df <- df[order(-df$count),]
ggplot(df, aes(x = reorder(Anio, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```
#### **Ine**


```{r}
#Departamento
df <- datosIne %>%
  group_by(depocu) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:10,]
df$n <- 1
for (i in 1:nrow(df)){
  df[i,]$n <- i
}
print(df)
ggplot(df, aes(x = reorder(n, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Municipio
df <- datosIne %>%
  group_by(mupocu) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:20,]
df$n <- 1
for (i in 1:nrow(df)){
  df[i,]$n <- i
}
print(df)
ggplot(df, aes(x = reorder(n, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```


```{r}
#Sexo
df <- datosIne %>%
  group_by(sexo) %>%
  summarise(count = n())
df <- df[order(-df$count),]
print(df)
ggplot(df, aes(x = reorder(sexo, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Día de ocurrencia
df <- datosIne %>%
  group_by(diaocu) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:10,]
print(df)
ggplot(df, aes(x = reorder(diaocu, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Año de registro
df <- datosIne %>%
  group_by(anoreg) %>%
  summarise(count = n())
df <- df[order(-df$count),]
print(df)
ggplot(df, aes(x = reorder(anoreg, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Mes de ocurrencia
df <- datosIne %>%
  group_by(mesocu) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:9,]
print(df)
ggplot(df, aes(x = reorder(mesocu, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Edad de difuntos 
df <- datosIne %>%
  group_by(edadif) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:10,]
print(df)
ggplot(df, aes(x = reorder(edadif, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Estado civil
df <- datosIne %>%
  group_by(ecidif) %>%
  summarise(count = n())
df <- df[order(-df$count),]
print(df)
ggplot(df, aes(x = reorder(ecidif, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

```{r}
#Escolaridad del difunto
df <- datosIne %>%
  group_by(escodif) %>%
  summarise(count = n())
df <- df[order(-df$count),]
print(df)
ggplot(df, aes(x = reorder(escodif, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()

```

```{r}
#Departamwnto de residencia del difunto
df <- datosIne %>%
  group_by(dredif) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:10,]
df$n <- 1
for (i in 1:nrow(df)){
  df[i,]$n <- i
}
print(df)
ggplot(df, aes(x = reorder(n, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```

```{r}
#Municipio de residencia del difunto
df <- datosIne %>%
  group_by(mredif) %>%
  summarise(count = n())
df <- df[order(-df$count),]
df <- df[1:10,]
df$n <- 1
for (i in 1:nrow(df)){
  df[i,]$n <- i
}
print(df)
ggplot(df, aes(x = reorder(n, count), y = count)) + geom_bar(fill = "blue", stat = "identity") + geom_text(aes(label = count), vjust = -0.5) + theme_pubclean()
```


```{r}
#Convert categorical dataset into numerical categorical
datosIneN <- datosIne
datosIneN$depocu <- as.numeric(factor(datosIne$depocu))
datosIneN$mupocu <- as.numeric(factor(datosIne$mupocu))
datosIneN$sexo <- as.numeric(factor(datosIne$sexo))
datosIneN$diaocu <- as.numeric(factor(datosIne$diaocu))
datosIneN$anoreg <- as.numeric(factor(datosIne$anoreg))
datosIneN$mesocu <- as.numeric(factor(datosIne$mesocu))
datosIneN$edadif <- as.numeric(factor(datosIne$edadif))
datosIneN$ecidif <- as.numeric(factor(datosIne$ecidif))
datosIneN$escodif <- as.numeric(factor(datosIne$escodif))
datosIneN$dredif <- as.numeric(factor(datosIne$dredif))
datosIneN$mredif <- as.numeric(factor(datosIne$mredif))
datosIneN$caudef <- as.numeric(factor(datosIne$caudef))
datosIneN
```
```{r}
library(corrplot)
matriz_cor <- cor(datosIneN[-12])
matriz_cor
 corrplot(matriz_cor)
```

```{r}
wss <- (nrow(datosIneN[-12])-1)*sum(apply(datosIneN[-12],2,var))

for (i in 2:10) 
  wss[i] <- sum(kmeans(datosIneN[-12], centers=i)$withinss)

#<<<<<<< HEAD
plot(1:10, wss, type="b", xlab="Number of Clusters",  ylab="Within groups sum of squares")
```
#=======
Para poder llevar a cabo un mejor análisis de las variables categóricas del dataset de importaciones de la SAT, se le asignaron valores numéricos a cada instancia única de las variables, para así poder utilizar varias herramientas de análisis como histogramas, mapas de calor, matrices de correlación y otras.
```{r}
#Convert categorical dataset into numerical categorical
datosSAT<-datos
datosSAT$Pais.de.Proveniencia <- as.numeric(factor(datosSAT$Pais.de.Proveniencia))
datosSAT$Modelo.del.Vehiculo <- as.numeric(factor(datosSAT$Modelo.del.Vehiculo))
datosSAT$Marca <- as.numeric(factor(datosSAT$Marca))
datosSAT$Linea <- as.numeric(factor(datosSAT$Linea))
datosSAT$Distintivo <- as.numeric(factor(datosSAT$Distintivo))
datosSAT$Tipo.de.Vehiculo <- as.numeric(factor(datosSAT$Tipo.de.Vehiculo))
datosSAT$Tipo.Combustible <- as.numeric(factor(datosSAT$Tipo.Combustible))
datosSAT
```
#### **Clusters SAT**
```{r}
library(factoextra)
library(cluster)
library(corrplot)
library(fpc)
corel <- cor(datosSAT)
corel
corrplot(corel)

wcss <- vector()
for(i in 1:10){
  wcss[i] <- sum(kmeans(datosSAT, i)$withinss)
}

ggplot() + geom_point(aes(x = 1:10, y = wcss), color = 'blue') + 
  geom_line(aes(x = 1:10, y = wcss), color = 'blue') + 
  ggtitle("Método del Codo") + 
  xlab('Cantidad de Centroides k') + 
  ylab('WCSS')
```
Debido a que la cantidad de datos que se encuentra en el dataset de importaciones de la SAT es más de 2 millones de filas con 16 columnas, varios de los métodos de análisis que se implementaron no podían soportar un manejo de datos tan grande por lo cual se tuvo que crear samples del dataset del tamaño más grande que fuera posible para el método. Específicamente para la prueba de la silueta, no se pudo evaluar sobre todos los datos, pero como se puede observar sobre el sample que se obtuvo, el resultado fue consistentemente alrededor de 0.80 por lo cual la clasificación por clustering elegida con K-means fue aceptable definiendo 2 centroides de acuerdo a la gráfica de codo. 

```{r} 
k <- kmeans(datosSAT, centers = 2)
p <- fviz_cluster(k, geom = "point", data = datosSAT)+ ggtitle("k = 2")
p
datosSAT$kgroup <- k$cluster
plotcluster(datosSAT[,-c(17)],k$cluster)
sam<-sample(1:nrow(datosSAT),20000)
silkm<-silhouette(datosSAT[sam,"kgroup"],dist(datosSAT[sam,1:16]))
mean(silkm[,3])
```


```{r} 
library(e1071)#para cmeans
library(cluster) #Para calcular la silueta
datosSample <- sample(1:nrow(datosSAT), 10000)
#cmeans
fcm<-cmeans(datosSAT,2)
datosSAT$FCGrupos<-fcm$cluster
#silueta
silfcm<-silhouette(datosSAT[datosSample,"FCGrupos"],dist(datosSAT[datosSample,1:16]))
mean(silfcm[,3])
```
#### **Clusters INE**
```{r} 
#Cluster Kmeans
library(cluster) #Para calcular la silueta
library(fpc)
km<-kmeans(datosIneN[-12],2)
plotcluster(datosIneN[-12],km$cluster)

#Método de la silueta para las k-medias
silkm<-silhouette(km$cluster,dist(datosIneN[-12]))
silkm
mean(silkm[,3]) #0.55, no es la mejor partición pero no está mal
```

```{r}
#Cluster Kmodes
library(klaR)
kmo<-kmodes(datosIneN[-12], 2, iter.max = 10, weighted = FALSE)
#kmo
plotcluster(datosIneN[-12],kmo$cluster)

#Método de la silueta para las k-medias
silkm<-silhouette(kmo$cluster,dist(datosIneN[-12]))
mean(silkm[,3]) #0.55, no es la mejor partición pero no está mal
```

```{r}
plotp1 <- datosIneN[-12]
plotp2 <- plotp1[6:11] 
plotp1 <- plotp1[1:6]
plot(plotp1)
plot(plotp2)

```

```{r}
#datosIneN
dc <-  datosIneN[c(2,3,4,6,8,10)]
km<-kmeans(dc,2)
plotcluster(dc,km$cluster)
silkm<-silhouette(km$cluster,dist(dc))
mean(silkm[,3]) 
```


```{r}
#datosIneN
library(e1071)
dc <-  datosIneN[c(2,3,4,6,8,10)]
cm<-cmeans(dc,2)
plotcluster(dc,cm$cluster)
silkm<-silhouette(cm$cluster,dist(dc))
mean(silkm[,3]) 
```

```{r}
#datosIneN
library(mclust)
dc <-  datosIneN[c(3,5,6,11)]
mc<-Mclust(dc,2)
plot(mc, what = "classification", main="MClust Classification")
silmg<-silhouette(mc$classification,dist(dc))
mean(silmg[,3])
```

```{r}
#datosIneN
library(mclust)
dc <-  datosIneN[c(3,5,6,11)]
hc<-hclust(dist(dc))
plot(hc)
rect.hclust(hc,k=2)
groups<-cutree(hc,k=2)
silch<-silhouette(groups,dist(dc))
mean(silch[,3])

```

